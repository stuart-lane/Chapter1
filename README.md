# Chapter 1
This repository contains MATLAB and Python code for replicating Chapter 1 "Overidentification testing with weak instruments and heteroskedasticity" of the Thesis "Estimation and Inference with Weak Instruments".


## Abstract

Exogeneity is a key identifying assumption for IV estimators, the validity of which is tested using overidentifying restrictions. We discuss the use of the invariant Kleibergen-Paap (KP) rank test (Kleibergen \& Paap, 2006) as a test for overidentification and compare to the Hansen ($J$) test (Hansen, 1982). Invariance has long been recognised as linked to good finite-sample properties (e.g. Hillier, 1990) and we provide evidence of favourable finite-sample power for KP over $J$. However, as both tests are asymptotically equivalent with strong instruments, we focus most of our attention on the situation where identification is weak. To facilitate this discussion, we derive the heteroskedastic weak instrument limit of the robust score test, which nests both the $J$ and KP tests as special cases (Windmeijer, 2018). This directly generalises the work of Staiger \& Stock (1997) on the homoskedastic Sargan test (Sargan, 1958) to the heteroskedastic case. An important consideration is that the size of these tests will depend on model parameters that are not consistently estimable under weak identification, such as the strength of endogeneity. We show in Monte Carlo simulations that KP tends to perform better than $J$ and is far less prone to severe size distortions. Coupled with favourable finite-sample properties under strong identification, we therefore provide a heuristic recommendation that the KP test should be used for overidentification testing over the typical $J$ test.
